(executable
 (name gen)
 (modules gen)
 (libraries codegen ppxlib)
 (preprocess (pps ppxlib.metaquot)))

(executable
 (name main)
 (modules main)
 (libraries test_gen codegen ppxlib))

(library
 (name test_gen)
 (modules test_gen))

(rule
 (targets test_gen.ml)
 (deps   (:gen gen.exe))
 (action (with-stdout-to %{targets} (run %{gen})))
 (mode   (promote (until-clean))))
